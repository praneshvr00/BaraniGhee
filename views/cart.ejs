<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cart</title>
    <link rel = "icon" href = 
    "img/mainlogo.png"
            type = "image/x-icon">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <script src="https://code.iconify.design/2/2.2.1/iconify.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <style>
          * {
          padding: 0;
          margin: 0;
        }
        .navb {
          top: 0;
          position: fixed;
        }
        .burgericon {
          display: none !important;
        }
        .navbarOverlay {
          width: 100%;
          height: 400px;
          z-index: 9;
          opacity: 0.7;
          position: fixed;
          top: 70px;
          background-color: rgb(0, 0, 0);
          display: none;
        }
        .navbarOverlay .Ovmenu {
          width: 100%;
          height: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
        }
        .navbarOverlay ul {
          width: 100%;
          height: 100%;
          display: flex;
          flex-direction: column;
          justify-content: center;
          /* background-color: #06f; */
          /* text-align: center; */
        }
        .navbarOverlay ul li {
          margin: 10px;
          list-style-type: none;
        }
        .navbarOverlay ul li a {
          color: #fff;
        }
        @media screen and (max-width: 708px) {
          .image-container {
            width: 100% !important;
          }
          .navb {
            width: 100vw;
          }
          .navb .logo img {
            /* padding-left: 50%; */
          }
          .navb .menu {
            display: none;
            width: 100vw;
          }
          .navb .menu ul {
            width: 98vw;
          }
          .navb .burgericon {
            display: inline-block !important;
            position: absolute;
            right: 20px;
            top: 15px;
          }
          .prodContainer {
            margin-top: 100px;
            width: 100vw;
            height: fit-content;
            flex-direction: column;
          }
          .prodContainer .wrapper {
            width: 100%;
          }
          .prodContainer .wrapper .box {
            flex-direction: column;
            margin-bottom: 10px;
          }
          .prodContainer .wrapper .box .imgContainer img {
            width: 350px;
          }
          .prodContainer .wrapper .box .imgContainer {
            width: 100%;
            height: fit-content;
          }
          .prodContainer .wrapper .box .textContainer {
            width: fit-content;
            height: fit-content;
            /* text-align: center; */
            margin-left: 20px;
          }
          .prodContainer .wrapper .box .textContainer .desc p {
            font-size: 1.7rem;
          }
          .prodContainer .wrapper .box .textContainer .title h1{
            font-size: x-large;
          }
          .prodContainer .wrapper .box .textContainer .ingredients h3{
            font-size: large;
          }
          #box2 {
            order: -1;
          }
        }
        #userImg img{
          width: 60px;
          height: 60px;
          object-fit: cover;
          border-radius: 50%;
        }
        @media screen and (max-width: 708px) {
          #userImg {
            margin-right: 0 !important;
            margin-left: auto !important;

          }
          
        }
          
      #userImg img{
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 50%;
    }
    @media screen and (max-width: 708px) {
      #userImg {
        margin-right: 0 !important;
        margin-left: auto !important;

      }
      .cartContainer .wrapper{
        width: 90%;
      }
      .cartContainer .wrapper .box{
        width: 100%;
      }
      .cartContainer .wrapper .box .imgContainer img{
        margin-left: 5px;
      }
      .cartContainer .wrapper .box .desc{
        width: 30%;
      }
      .cartContainer .wrapper .box .price{
        width: 10%;
      }
      .cartContainer .wrapper .box .price h2{
        font-size: larger;
      }
    }
    </style>
  </head>
  <body>
    <% if(paid) { %>
      <script> alert("order placed") </script>
    <% } %>
    <span class="navbarOverlay" id="showOverlay">
      <div class="Ovmenu">
        <ul>
          <span
            onclick="showMenu()"
            class="cross"
            style="color: #fff; position: absolute; left: 20px; top: 20px"
          >
            <i class="fa-solid fa-3x fa-xmark"></i>
          </span>
          <li><a href="/">Home </a></li>
          <li><a href="product"> Product </a></li>
          <li><a href="contact"> Contact Us </a></li>
          <li><a href="about"> About Us </a></li>
          <li><a href="shop"> Shop </a></li>
          <% if (user == null) { %>
            <li><a href="signup"> Login/Signup </a></li>
          <% } else { %> 
              <li><a href="profile"> Profile </a></li>
              <li><a href="orders"> My Orders </a></li>
              <li><a href="logout"> Logout </a></li>
          <% } %>
          <li>
            <a href="#"> <i class="fas fa-2x fa-shopping-cart"></i> </a>
          </li>
        </ul>
      </div>
    </span>
    <div class="image-container">
      <p class="image-holder">
        <img src="img/loading.gif" />
      </p>
    </div>
    <div class="navb">
      <div class="logo" style="display: flex;justify-content: space-between; ">
        
        <% if (url) { %>
         <div id="userImg">
          <img  src = <%= url %>   referrerpolicy="no-referrer" />
         </div>
        <% } else { %> 
          
        <% } %>
        <img id="barani" src="img/mainlogo.png" />
      </div>
      <div class="name"></div>
      <div class="menu">
        <ul>
          <li><a href="/"> Home </a></li>
          <li><a href="product"> Product </a></li>
          <li><a href="contact"> Contact Us </a></li>
          <li><a href="about"> About Us </a></li>
          <li><a href="shop"> Shop </a></li>
          <% if (user == null) { %>
          <li><a href="signup"> Login/Signup </a></li>
          <% } else { %> 
            <li><a href="profile"> Profile </a></li>
            <li><a href="orders"> My Orders </a></li>
            <li><a href="logout"> Logout </a></li>
          <% } %>
          <li>
            <a href="#"> <i class="fas fa-2x fa-shopping-cart"></i> </a>
          </li>
        </ul>
      </div>
      <div
      id="burgericon"
      class="burgericon"
      style="display: flex; align-items: center"
      onclick="showMenu()"
    >
      <i class="fa-solid fa-3x fa-bars"></i>
    </div>
    </div>
    <!-- cart  -->
    <div class="cartContainer">
        <div class="wrapper">
          <% if(cartItem.length == 0) { %>
            <h3> Your cart is empty !</h3>
          <% } %>
          <% for (var i = 0; i < cartItem.length; i++) { %>
          <div class="box" id="cartData">
            <div class="imgContainer">
              <img src= <%= cartItem[i].productimg %> width="100px" height="100px">
            </div>
            <div class="desc">
              <h3><b>Description:</b> </h3>
              <h5><b>Category:</b> <%= cartItem[i].category %></h5>
              <h5><b>Quantity:</b> <%= cartItem[i].quantity %></h5>
            </div>
            <div class="price">
              <h2><b>Price:</b> <%= cartItem[i].amount %></h2>
            </div>
            <div class="pay"> 
              <form action="pay" method="POST">
              <input type="hidden" name="cartId" id="cartId" value="<%= cartItem[i].id %>">
              <input type="hidden" name="cartAmount" id="cartAmount" value="<%= cartItem[i].amount %>">
              <input type="hidden" name="cartCategory" id="cartCategory" value="<%= cartItem[i].category %>">
              <input type="hidden" name="cartQuantity" id="cartQuantity" value="<%= cartItem[i].quantity %>">
              <input type="hidden" name="productId" id="productId" value="<%= cartItem[i].productId %>">
              <button type="submit" cart-amount="<%= cartItem[i].amount %>" cart-id="<%= cartItem[i].id %>" id="paybutton" class="paybutton"> Pay </button></form> 
            </form>
            <button type="button" class="cartDelete" id="cartDelete" cart-id="<%= cartItem[i].id %>" > Delete </button> 
            </div>
          </div>
          <% } %>
        </div>
      </div>
    <!--  footer -->
    <div class="cartFooter">
    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 col-md-6">
            <strong><h6>About</h6></strong>
            <p class="text-justify">
              Scanfcode.com <i>CODE WANTS TO BE SIMPLE </i> is an initiative to
              help the upcoming programmers with the code. Scanfcode focuses on
              providing the most efficient code or snippets as the code wants to
              be simple. We will help programmers build up concepts in different
              programming languages that include C, C++, Java, HTML, CSS,
              Bootstrap, JavaScript, PHP, Android, SQL and Algorithm.
            </p>
          </div>

          <div class="col-xs-6 col-md-3">
            <strong><h6>Categories</h6></strong>
            <ul class="footer-links">
              <li><a href="">C</a></li>
              <li>
                <a href="">UI Design</a>
              </li>
              <li>
                <a href="">PHP</a>
              </li>
              <li>
                <a href="">Java</a>
              </li>
              <li>
                <a href="">Android</a>
              </li>
              <li>
                <a href="">Templates</a>
              </li>
            </ul>
          </div>

          <div class="col-xs-6 col-md-3">
            <strong><h6>Quick Links</h6></strong>
            <ul class="footer-links">
              <li><a href="http://scanfcode.com/about/">About Us</a></li>
              <li><a href="http://scanfcode.com/contact/">Contact Us</a></li>
              <li>
                <a href="http://scanfcode.com/contribute-at-scanfcode/"
                  >Contribute</a
                >
              </li>
              <li>
                <a href="http://scanfcode.com/privacy-policy/"
                  >Privacy Policy</a
                >
              </li>
              <li><a href="http://scanfcode.com/sitemap/">Sitemap</a></li>
            </ul>
          </div>
        </div>
        <hr />
      </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8 col-sm-6 col-xs-12">
            <p class="copyright-text">
              Copyright &copy; 2017 All Rights Reserved by
              <a href="#">Scanfcode</a>.
            </p>
          </div>

          <div class="col-md-4 col-sm-6 col-xs-12">
            <ul class="social-icons">
              <li>
                <a class="facebook" href="#"
                  ><i class="fa-brands fa-facebook"></i
                ></a>
              </li>
              <li>
                <a class="twitter" href="#"
                  ><i class="fa-solid fa-envelope"></i
                ></a>
              </li>
              <li>
                <a class="dribbble" href="#"
                  ><i class="fa-brands fa-instagram"></i
                ></a>
              </li>
              <li>
                <a class="linkedin" href="#"
                  ><i class="fa-solid fa-phone"></i
                ></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
  </div>
    <link
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"
      type="text/css"
      rel="stylesheet"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"
      type="text/javascript"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"
      type="text/javascript"
    ></script>
    <!-- <script>
      $("#paybutton").click(function(){

      })
    </script> -->
    <script>
      function showMenu() {
        var show = document.getElementById("showOverlay");
        var icon = document.getElementById("burgericon");

        if (show.style.display == "inline") {
          show.style.display = "none";
        } else {
          show.style.display = "inline";
        }
      }
      $.each($("*"), function () {
        if ($(this).width() > $("body").width()) {
          console.log("Wide Element: ", $(this), "Width: ", $(this).width());
        }
      });
    </script>
    <script>
      
      $("div.image-container").delay(850).fadeOut("slow");
    </script>
    <script>
    $(".cartDelete").click(function(){
        var cartid = $(this).attr('cart-id');
        $.ajax({
          type: "GET",
          url: "cartDelete",
          data: {
            cart_id : cartid,
          },
          success:function(cartItem){
            alert("Item Deleted");
            console.log(cartItem)
           document.location.reload();
          }
        }) 
      })
    </script>
    <!-- <script>
    var orderId;
    $("paybutton").hide()
    $(document).ready(function(){
      var settings = {
        "url": "/create/orderId",
        "method": "POST",
        "timeout": 0,
        "headers": {
          "Content-type": "application/json"
        },
        "data": JSON.stringify({
          "amount": "10"
        }),
      };
    })
      document.getElementsByClassName('paybutton').onclick = function(e){
        var options = {
        "key": "rzp_test_rjby0an5RdnGXz", // Enter the Key ID generated from the Dashboard
        "amount": "10", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
        "currency": "INR",
        "name": "Ghee",
        "description": "buy ghee",
        "image": "https://example.com/your_logo",
        "order_id": orderId, //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
        "handler": function (response){
            alert(response.razorpay_payment_id);
            alert(response.razorpay_order_id);
            alert(response.razorpay_signature)
        var settings = {
        "url": "/api/payment/verify",
        "method": "POST",
        "timeout": 0,
        "headers": {
          "Content-Type": "application/json"
        },
        "data": JSON.stringify({response}),
        }
      $.ajax(settings).done(function(response){
        // orderId = response.orderId;
        // console.log(orderId);
        // $("#paybutton").show();
        alert(JSON.stringify(response));
    });
    "theme": {
        "color": "#3399cc"
    }};
    var rzp1 = new Razorpay(options);
    rzp1.on('payment.failed', function (response){
        alert(response.error.code);
        alert(response.error.description);
        alert(response.error.source);
        alert(response.error.step);
        alert(response.error.reason);
        alert(response.error.metadata.order_id);
        alert(response.error.metadata.payment_id);
    });
    rzp1.open();
    e.preventDefault();
  }
}
  
    </script> -->
  </body>
</html>
